var _grupoNotas, _acordeSelecionado = "", _acordeAntesSelecionado = "", _acompanhamentoSelecionado = "", _acompanhamentoSolo = !1, _acompanhamentoFull = !1, _acompanhamentoMao = !1, _volume = .9, _instrumentoSelecionado = "orgao"; const notasAcordes = Object.keys(notasAcordesJson); var tremolo = new Pizzicato.Effects.Tremolo({ speed: 1, depth: .6, mix: .8 }), flanger = new Pizzicato.Effects.Flanger({ time: .45, speed: .2, depth: .1, feedback: .1, mix: .2 }), pingPongDelay = new Pizzicato.Effects.PingPongDelay({ feedback: .6, time: .4, mix: .5 }); function deixarAcompanhamentoSelecionado(e) { escolherAcompanhamento(e, document.getElementById(e)) } function ocultarBotaoRec(e = !0) { e ? (document.getElementById("gravar").style.display = "none", document.getElementById("play-pause").style.display = "block") : (document.getElementById("gravar").style.display = "block", document.getElementById("play-pause").style.display = "none") } function escolherAcorde(e, o) { _acordeSelecionado = _acordeAntesSelecionado == e ? "" : e, levantarBotoesAcordes(), "" == _acordeSelecionado ? (_acordeAntesSelecionado = _acordeSelecionado, pararOsAcordes(), ocultarBotaoRec(!1)) : (tocarAcorde(e, o), ocultarBotaoRec()) } function escolherAcompanhamento(e, o) { _acompanhamentoSelecionado = e, pressionarBotaoAcompanhamento(o) } function tocarAcorde(e, o) { _acordeAntesSelecionado != e && (verificarAcompanhamentoEtocar(o.value), o.classList.toggle("pressionado", !0)) } function setTom(e = "C") { document.getElementById("tomSelect").value = e } function criarAcorde(e, o) { e.includes("_") && (e = e.split("_")[1]); for (var a = notasAcordesJson[e], n = 0, t = a.length; n < t; n++)("full" == _acompanhamentoSelecionado || "baixo" == _acompanhamentoSelecionado) && 1 != n && o.addSound(acordes["orgao_" + a[n] + "_baixo"]), ("full" == _acompanhamentoSelecionado || "mao" == _acompanhamentoSelecionado) && o.addSound(acordes["orgao_" + a[n]]); return o } function verificarGrupoNotasInstanciado(e) { return null == e && ((e = new Pizzicato.Group).addEffect(flanger), e.volume = _volume), e } function verificarAcompanhamentoEtocar(e) { pararOsAcordes(!0), _acordeAntesSelecionado = e, _grupoNotas = verificarGrupoNotasInstanciado(_grupoNotas), "orgao" == _instrumentoSelecionado ? _grupoNotas = criarAcorde(e, _grupoNotas) : _grupoNotas.addSound(acordes["strings_" + e]), _grupoNotas.play() } function pararOsAcordes(e = !1) { if (null != _grupoNotas && (_grupoNotas.stop(), e)) { var o = _grupoNotas.sounds.length; for (let a = o - 1; a > -1; a--)_grupoNotas.removeSound(_grupoNotas.sounds[a]) } } function levantarBotoesAcordes() { var e = document.getElementsByClassName("pressionado"); e.length > 0 && e[0].classList.toggle("pressionado", !1) } function levantarBotoesAcompanhamento() { var e = document.getElementsByClassName("selecionado"); for (let o = 0; o < e.length; o++)e[o].classList.toggle("selecionado", !1) } function pressionarBotaoAcompanhamento(e) { !1 == botaoAcompPressionado(e) && ("" != _acordeAntesSelecionado && verificarAcompanhamentoEtocar(_acordeAntesSelecionado), levantarBotoesAcompanhamento(), pressionarBotaoAcomp(e)) } function botaoAcompPressionado(e) { return !!e.classList.contains("selecionado") } function pressionarBotaoAcomp(e) { e.classList.toggle("selecionado", !0) } function alterarVolume(e, o) { _volume = parseFloat(e), null != _grupoNotas && (_grupoNotas.volume = _volume); var a = document.getElementById("volumeTexto"); e == o ? a.innerHTML = 10 * e : a.innerHTML = 10 * e + "*" } function mudarTom(e) { var o = acordesCampoHarmonicoJson[e]; Array.from(document.getElementsByClassName("acorde")).forEach(e => { var a = e.id.split("_")[1]; e.value = o[a] }); var a = document.getElementsByClassName("pressionado"); if (a.length > 0) { var n = a[0]; escolherAcorde("orgao_" + n.value, n) } mudarTomMenor(document.getElementById("tomSelect").selectedIndex) } function mudarTomMenor(e) { document.getElementById("textoAcordeMenor").innerText = acordesTons[e + 12] } function aumentarTom(e) { var o = document.getElementById("tomSelect"), a = o.selectedIndex; e ? a == o.length - 1 ? o.value = acordesTons[0] : o.value = acordesTons[a + 1] : 0 == a ? o.value = acordesTons[o.length - 1] : o.value = acordesTons[a - 1], mudarTom(o.value) } deixarAcompanhamentoSelecionado("full"), document.getElementById("instrumentoSelect").addEventListener("change", e => { var o; _instrumentoSelecionado = document.getElementById("instrumentoSelect").value.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase() });