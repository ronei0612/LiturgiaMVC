var accessToken;const clientId="982717214287-u57uddj8lrd7dq0n5i4fquuvci8umd60.apps.googleusercontent.com",redirectUri="https://localhost:7188/orgao",scope="https://www.googleapis.com/auth/drive";function authorizeGoogle(){let o=`https://accounts.google.com/o/oauth2/auth?client_id=982717214287-u57uddj8lrd7dq0n5i4fquuvci8umd60.apps.googleusercontent.com&redirect_uri=https://localhost:7188/orgao&response_type=token&scope=${encodeURIComponent("https://www.googleapis.com/auth/drive")}`;window.location.href=o}function processToken(){let o=new URLSearchParams(window.location.hash.substr(1)),e=o.get("access_token");o.get("state"),e?(localStorage.setItem("accessToken",e),console.log("Token de acesso obtido com sucesso:",e)):console.error("Erro ao obter o token de acesso ou ID da pasta.")}function lerArquivo(o){if(o||(o=localStorage.getItem("fileId")),!o){console.log("Arquivo ainda n\xe3o criado");return}let e=localStorage.getItem("accessToken");if(!e){console.error("Token de acesso n\xe3o encontrado.");return}fetch(`https://www.googleapis.com/drive/v3/files/${o}?alt=media`,{method:"GET",headers:{Authorization:`Bearer ${e}`}}).then(o=>o.text()).then(o=>{console.log("Conte\xfado do arquivo:",o)}).catch(o=>{console.error("Erro ao ler o arquivo:",o)})}function criarArquivoComTexto(o){let e=localStorage.getItem("accessToken");if(!e){console.error("Token de acesso n\xe3o encontrado.");return}fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=media",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"text/plain"},body:o}).then(o=>o.json()).then(o=>{let e=o.id,t=`https://drive.google.com/file/d/${e}/view`;console.log("Arquivo criado com sucesso. ID do arquivo:",e),console.log("File uploaded link:",t),localStorage.setItem("fileId",e)}).catch(o=>{console.error("Erro ao criar o arquivo:",o)})}function editarArquivo(o){let e=localStorage.getItem("accessToken");if(!e){console.error("Token de acesso n\xe3o encontrado.");return}let t=localStorage.getItem("fileId");if(!t){criarArquivoComTexto("bbb");return}let r=`https://www.googleapis.com/upload/drive/v3/files/${t}`;fetch(r,{method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:o}).then(o=>{o.ok?console.log("Arquivo editado com sucesso."):console.error("Erro ao editar o arquivo:",o.statusText)}).catch(o=>{console.error("Erro ao editar o arquivo:",o)})}function validarToken(){if(!(accessToken=localStorage.getItem("accessToken"))){authorizeGoogle(),console.error("Token de acesso n\xe3o encontrado.");return}fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`).then(o=>{if(!o.ok)throw Error("Erro ao validar o token:",o.status);return o.json()}).then(o=>{console.log("Informa\xe7\xf5es do token:",o)}).catch(o=>{console.error(o),localStorage.removeItem("accessToken"),authorizeGoogle()})}window.onload=function(){window.location.hash&&processToken()};